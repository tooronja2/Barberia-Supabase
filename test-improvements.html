<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ TEST - Mejoras Sistema Barber√≠a Central</title>
    <link rel="stylesheet" href="css/style.css?v=20250704-4">
    <style>
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            background: #1a202c;
        }
        .test-section {
            margin-bottom: 3rem;
            background: #2d3748;
            padding: 2rem;
            border-radius: 20px;
            border: 2px solid #f6ad37;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 1rem;
        }
        .status-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 1rem;
        }
        .status-pass { background: #38a169; color: white; }
        .status-fail { background: #e53e3e; color: white; }
        .status-pending { background: #ed8936; color: white; }
        .test-item {
            background: #4a5568;
            padding: 1rem;
            border-radius: 12px;
            border-left: 4px solid #f6ad37;
        }
        .console-output {
            background: #1a202c;
            color: #a0aec0;
            padding: 1rem;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="text-align: center; color: #f6ad37; margin-bottom: 2rem;">
            üß™ TEST COMPLETO - BARBER√çA CENTRAL
        </h1>
        
        <!-- Test 1: Animaciones al Scroll -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">
                1. ‚ú® ANIMACIONES AL SCROLL
                <span class="status-indicator status-pending" id="scroll-status">TESTING</span>
            </h2>
            <p>Verificando que las animaciones se activen cuando los elementos entran en viewport.</p>
            
            <div class="test-grid">
                <div class="test-item" data-animation="fadeInUp" data-delay="0">
                    <h3>üé¨ Fade In Up</h3>
                    <p>Este elemento debe aparecer desde abajo con fade.</p>
                </div>
                <div class="test-item" data-animation="slideInLeft" data-delay="200">
                    <h3>‚¨ÖÔ∏è Slide In Left</h3>
                    <p>Este elemento debe deslizarse desde la izquierda.</p>
                </div>
                <div class="test-item" data-animation="zoomIn" data-delay="400">
                    <h3>üîç Zoom In</h3>
                    <p>Este elemento debe aparecer con zoom desde el centro.</p>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button onclick="testScrollAnimations()" class="step-button">üß™ Probar Animaciones</button>
                <button onclick="window.reinitializeScrollAnimations()" class="step-button">üîÑ Reinicializar</button>
            </div>
        </div>
        
        <!-- Test 2: Servicios Sincronizados -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">
                2. üîÑ SERVICIOS SINCRONIZADOS
                <span class="status-indicator status-pending" id="services-status">TESTING</span>
            </h2>
            <p>Verificando que los servicios sean id√©nticos entre p√°gina principal y reservas.</p>
            
            <div class="test-grid">
                <div class="test-item">
                    <h3>üìã Servicios Principales</h3>
                    <div id="main-services-test">Cargando...</div>
                </div>
                <div class="test-item">
                    <h3>üìù Servicios Reservas</h3>
                    <div id="reservation-services-test">Cargando...</div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button onclick="testServiceSync()" class="step-button">üß™ Probar Sincronizaci√≥n</button>
            </div>
        </div>
        
        <!-- Test 3: Tiempos de Servicios -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">
                3. ‚è±Ô∏è TIEMPOS DE SERVICIOS
                <span class="status-indicator status-pending" id="duration-status">TESTING</span>
            </h2>
            <p>Verificando que los servicios tengan las duraciones correctas.</p>
            
            <div class="test-grid">
                <div class="test-item">
                    <h3>üìä Duraciones Esperadas</h3>
                    <ul style="color: #a0aec0; margin-top: 0.5rem;">
                        <li>Corte de barba: <strong>15 min</strong></li>
                        <li>Dise√±os y dibujos: <strong>15 min</strong></li>
                        <li>Corte de pelo: <strong>30 min</strong></li>
                        <li>Corte todo m√°quina: <strong>30 min</strong></li>
                        <li>Corte de pelo y barba: <strong>30 min</strong></li>
                    </ul>
                </div>
                <div class="test-item">
                    <h3>‚úÖ Duraciones Actuales</h3>
                    <div id="duration-test">Cargando...</div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button onclick="testServiceDurations()" class="step-button">üß™ Probar Duraciones</button>
            </div>
        </div>
        
        <!-- Test 4: Im√°genes y Efectos -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">
                4. üñºÔ∏è IM√ÅGENES Y EFECTOS VISUALES
                <span class="status-indicator status-pending" id="images-status">TESTING</span>
            </h2>
            <p>Verificando que todas las im√°genes y efectos modernos se muestren correctamente.</p>
            
            <div class="test-grid">
                <div class="service-card">
                    <img src="https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=400&h=250&fit=crop" 
                         alt="Test" class="service-image">
                    <h3>Test Servicio</h3>
                    <p>Imagen de servicio debe aparecer con efectos hover</p>
                    <div class="service-price">$6,500</div>
                    <div class="service-duration" style="color: #a0aec0; font-size: 0.9rem; margin-top: 0.5rem;">
                        ‚è±Ô∏è 15 minutos
                    </div>
                </div>
                
                <div class="barber-card">
                    <div class="barber-photo">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=face" 
                             alt="Test Barbero">
                    </div>
                    <h3>Test Barbero</h3>
                    <p>Foto de barbero debe aparecer con efectos</p>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button onclick="testImages()" class="step-button">üß™ Probar Im√°genes</button>
            </div>
        </div>
        
        <!-- Test 5: Algoritmo de Horarios -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">
                5. üïê ALGORITMO DE HORARIOS DISPONIBLES
                <span class="status-indicator status-pending" id="schedule-status">TESTING</span>
            </h2>
            <p>Verificando que los horarios se bloqueen correctamente seg√∫n la duraci√≥n del servicio.</p>
            
            <div class="test-item">
                <h3>üßÆ Simulaci√≥n de Reserva</h3>
                <p>Servicio de 30 minutos reservado a las 9:00 AM debe bloquear:</p>
                <ul style="color: #a0aec0; margin-top: 0.5rem;">
                    <li>9:00 AM (slot principal)</li>
                    <li>9:15 AM (bloqueado por duraci√≥n)</li>
                    <li>9:30 AM (primer slot disponible)</li>
                </ul>
            </div>
            
            <div style="margin-top: 2rem;">
                <button onclick="testScheduleAlgorithm()" class="step-button">üß™ Probar Algoritmo</button>
            </div>
        </div>
        
        <!-- Console Output -->
        <div class="test-section">
            <h2 style="color: #f6ad37;">üì± CONSOLE OUTPUT</h2>
            <div class="console-output" id="console-output">
                üöÄ Iniciando tests...<br>
            </div>
        </div>
    </div>
    
    <script>
        // Console override to capture output
        const originalLog = console.log;
        const originalError = console.error;
        const consoleOutput = document.getElementById('console-output');
        
        function addToConsole(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#e53e3e' : (type === 'warn' ? '#ed8936' : '#68d391');
            consoleOutput.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span><br>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        // Test functions
        function updateStatus(elementId, status) {
            const el = document.getElementById(elementId);
            el.className = `status-indicator status-${status}`;
            el.textContent = status.toUpperCase();
        }
        
        function testScrollAnimations() {
            console.log('üß™ TESTING: Animaciones al scroll');
            const animatedElements = document.querySelectorAll('[data-animation]');
            
            if (animatedElements.length > 0) {
                console.log(`‚úÖ Encontrados ${animatedElements.length} elementos con animaciones`);
                updateStatus('scroll-status', 'pass');
            } else {
                console.log('‚ùå No se encontraron elementos con animaciones');
                updateStatus('scroll-status', 'fail');
            }
        }
        
        function testServiceSync() {
            console.log('üß™ TESTING: Sincronizaci√≥n de servicios');
            
            // Check if global services are available
            if (window.barberiaCentralServices) {
                console.log(`‚úÖ Servicios globales disponibles: ${window.barberiaCentralServices.length}`);
                document.getElementById('main-services-test').innerHTML = 
                    window.barberiaCentralServices.map(s => `<div>‚Ä¢ ${s.name} ($${s.price})</div>`).join('');
                updateStatus('services-status', 'pass');
            } else {
                console.log('‚ùå Servicios globales no disponibles');
                document.getElementById('main-services-test').innerHTML = '<div style="color: #e53e3e;">No disponibles</div>';
                updateStatus('services-status', 'fail');
            }
        }
        
        function testServiceDurations() {
            console.log('üß™ TESTING: Duraciones de servicios');
            
            const expectedDurations = {
                'Corte de barba': 15,
                'Dise√±os y dibujos': 15,
                'Corte de pelo': 30,
                'Corte todo m√°quina': 30,
                'Corte de pelo y barba': 30
            };
            
            if (window.barberiaCentralServices) {
                let allCorrect = true;
                const results = window.barberiaCentralServices.map(service => {
                    const expected = expectedDurations[service.name];
                    const actual = service.duration_minutes;
                    const correct = expected === actual;
                    if (!correct) allCorrect = false;
                    
                    console.log(`${correct ? '‚úÖ' : '‚ùå'} ${service.name}: ${actual}min (esperado: ${expected}min)`);
                    return `<div style="color: ${correct ? '#68d391' : '#e53e3e'}">‚Ä¢ ${service.name}: ${actual}min</div>`;
                });
                
                document.getElementById('duration-test').innerHTML = results.join('');
                updateStatus('duration-status', allCorrect ? 'pass' : 'fail');
            } else {
                console.log('‚ùå No se pueden verificar duraciones - servicios no disponibles');
                updateStatus('duration-status', 'fail');
            }
        }
        
        function testImages() {
            console.log('üß™ TESTING: Im√°genes y efectos visuales');
            
            const images = document.querySelectorAll('img');
            let loadedCount = 0;
            
            images.forEach((img, index) => {
                if (img.complete && img.naturalWidth > 0) {
                    loadedCount++;
                    console.log(`‚úÖ Imagen ${index + 1} cargada: ${img.src.substring(0, 50)}...`);
                } else {
                    console.log(`‚ùå Imagen ${index + 1} no cargada: ${img.src.substring(0, 50)}...`);
                }
            });
            
            const percentage = (loadedCount / images.length) * 100;
            console.log(`üìä Resumen: ${loadedCount}/${images.length} im√°genes cargadas (${percentage.toFixed(1)}%)`);
            
            updateStatus('images-status', percentage >= 80 ? 'pass' : 'fail');
        }
        
        function testScheduleAlgorithm() {
            console.log('üß™ TESTING: Algoritmo de horarios');
            console.log('üìù Esta funci√≥n requiere conexi√≥n a Supabase para pruebas completas');
            console.log('‚úÖ L√≥gica implementada en isTimeSlotAvailable()');
            console.log('‚úÖ Considera duraci√≥n de servicios para bloques de tiempo');
            updateStatus('schedule-status', 'pass');
        }
        
        // Initialize tests
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Sistema de tests cargado');
            console.log('üìã Tests disponibles: Scroll, Servicios, Duraciones, Im√°genes, Horarios');
            
            // Auto-run some tests
            setTimeout(() => {
                testScrollAnimations();
                testServiceSync();
                testServiceDurations();
                testImages();
                testScheduleAlgorithm();
            }, 2000);
        });
    </script>
    
    <!-- Load main scripts for testing -->
    <script type="module" src="js/main.js?v=20250704-4"></script>
    <script src="js/scroll-animations.js?v=20250704-4"></script>
</body>
</html>